<!DOCTYPE html>
<html lang="en">
	<head>
		<link rel="stylesheet" href="style.css" />
		<title>Inverted Insights</title>
	</head>
	<body>
		<div id="demographics" class="demographics-container">
			<h1 style="text-align: center; color: rgb(14, 145, 157)">
				Please fill in your demographic information:
			</h1>
			<h3 style="color: rgb(14, 145, 157)">Age:</h3>
			<label><input type="radio" name="age" value="under-18" />Under 18</label>
			<label><input type="radio" name="age" value="18-30" />18-30</label>
			<label><input type="radio" name="age" value="31-45" />31-45</label>
			<label><input type="radio" name="age" value="46-60" />46-60</label>
			<label><input type="radio" name="age" value="above-60" />Above 60</label>

			<!-- Gender -->
			<h3 style="color: rgb(14, 145, 157)">Gender:</h3>
			<label><input type="radio" name="gender" value="male" />Male</label>
			<label><input type="radio" name="gender" value="female" />Female</label>
			<label><input type="radio" name="gender" value="other" />Other</label>

			<!-- Ethnicity/Race -->
			<h3 style="color: rgb(14, 145, 157)">Ethnicity/Race:</h3>
			<!-- Example options; consider adding more as appropriate -->
			<label><input type="radio" name="ethnicity" value="asian" />Asian</label>
			<label
				><input
					type="radio"
					name="ethnicity"
					value="black"
				/>Black/African</label
			>
			<label
				><input
					type="radio"
					name="ethnicity"
					value="hispanic"
				/>Hispanic/Latino</label
			>
			<label><input type="radio" name="ethnicity" value="white" />White</label>
			<label><input type="radio" name="ethnicity" value="other" />Other</label>

			<!-- Educational Background -->
			<h3 style="color: rgb(14, 145, 157)">Educational Background:</h3>
			<!-- Example options -->
			<label
				><input type="radio" name="education" value="high_school" />High
				School</label
			>
			<label
				><input type="radio" name="education" value="bachelor" />Bachelor's
				Degree</label
			>
			<label
				><input type="radio" name="education" value="master" />Master's
				Degree</label
			>
			<label
				><input type="radio" name="education" value="phd" />PhD or Higher</label
			>

			<!-- Vision Quality -->
			<h3 style="color: rgb(14, 145, 157)">Vision Quality:</h3>
			<label
				><input type="radio" name="vision" value="normal" />Normal Vision</label
			>
			<label
				><input type="radio" name="vision" value="corrected" />Corrected
				(Glasses/Contacts)</label
			>
			<label
				><input type="radio" name="vision" value="impaired" />Vision
				Impaired</label
			>

			<!-- Experience with Face Recognition Tasks -->
			<h3 style="color: rgb(14, 145, 157)">
				Experience with Face Recognition Tasks:
			</h3>
			<label><input type="radio" name="experience" value="none" />None</label>
			<label><input type="radio" name="experience" value="some" />Some</label>
			<label
				><input
					type="radio"
					name="experience"
					value="experienced"
				/>Experienced</label
			>
			<br /><br />
			<button class="btn" id="beginButton" onclick="beginStudy()">Begin</button>
		</div>

		<div class="container" style="display: none">
			<!-- Image display area -->
			<img
				id="surveyImage"
				src=""
				alt="Survey Image"
				style="max-width: 500px; display: block; margin: 20px auto"
			/>

			<div class="survey-container">
				<!-- Survey question (hidden by default) -->
				<div id="surveyQuestion" style="text-align: center; display: none">
					<p>Did you recognize this person?</p>
					<input
						type="radio"
						id="yes"
						name="recognition"
						value="yes"
						onchange="handleRecognitionChange()"
					/>
					<label for="yes">Yes</label>
					<input
						type="radio"
						id="no"
						name="recognition"
						value="no"
						onchange="handleRecognitionChange()"
					/>
					<label for="no">No</label>
					<input
						type="radio"
						id="maybe"
						name="recognition"
						value="maybe"
						onchange="handleRecognitionChange()"
					/>
					<label for="no">Maybe</label>
					<div id="nameInput" style="display: none">
						<input
							type="text"
							id="celebrityName"
							placeholder="Enter celebrity name"
						/>
					</div>
					<!-- Modified to use as Next button initially, then Submit -->
					<button class="btn" id="nextButton" onclick="nextPage()">Next</button>
				</div>
			</div>

			<script>
				function beginStudy() {
					// Hide the demographics section
					document.getElementById("demographics").style.display = "none";

					// Show the container for the image and survey
					document.querySelector(".container").style.display = "flex";

					// Proceed to load the first image
					loadNextImage();
				}

				// Embedded or fetched JSON data representing images
				var imageData = [
					{ path: "../Faces/000001.jpg" },
					{ path: "../Faces/000002.jpg" },
					{ path: "../Faces/000003.jpg" },
					{ path: "../Faces/000004.jpg" },
					{ path: "../Faces/000005.jpg" },
					{ path: "../Faces/000006.jpg" },
					// Add more image paths as needed
				];

				var currentImageIndex = 0;
				var responses = []; // To store survey responses

				document.addEventListener("DOMContentLoaded", function () {
					// only prepare the demographic form, do not load images yet
				});

				function loadNextImage() {
					if (currentImageIndex < imageData.length) {
						// Initially hide the survey question until the image is displayed and then hidden
						document.getElementById("surveyQuestion").style.display = "none";

						var imgPath = imageData[currentImageIndex].path;
						document.getElementById("surveyImage").src = imgPath;
						document.getElementById("surveyImage").style.display = "block"; // Make sure the image is visible

						// Wait for 2000 ms, then hide the image and show the survey question
						setTimeout(function () {
							document.getElementById("surveyImage").style.display = "none"; // Hide the image
							document.getElementById("surveyQuestion").style.display = "block"; // Show survey question after image is hidden
						}, 2000);

						resetSurveyForm();
					} else {
						// After the last image, prepare to submit responses
						prepareSubmit();
					}
				}

				function nextPage() {
					// Hide the image to prepare for the next action
					document.getElementById("surveyImage").style.display = "none";

					// Collect the recognition response
					var recognitionInput = document.querySelector(
						'input[name="recognition"]:checked'
					);
					var recognition = recognitionInput ? recognitionInput.value : "";
					var name =
						recognition === "yes" || recognition === "maybe"
							? document.getElementById("celebrityName").value
							: "";

					// Store the response
					responses.push({
						imageIndex: currentImageIndex,
						recognized: recognition,
						name: name,
					});

					// Clear the input for the next round
					document.getElementById("celebrityName").value = "";

					// Increment the image index to move to the next image
					currentImageIndex++;

					// Check if there are more images to display
					if (currentImageIndex < imageData.length) {
						loadNextImage(); // Load the next image
					} else {
						// No more images, prepare to submit responses
						prepareSubmit();
					}
				}

				function prepareSubmit() {
					// Change the button text to "Submit"
					document.getElementById("nextButton").textContent = "Submit";
					// Change the onclick function to submitResponses
					document.getElementById("nextButton").onclick = function () {
						submitResponses();
					};
					// Optionally, you could hide the survey question here or leave it if you want a final action from the user
					// document.getElementById("surveyQuestion").style.display = "none";
				}

				function handleRecognitionChange() {
					var recognition = document.querySelector(
						'input[name="recognition"]:checked'
					).value;
					document.getElementById("nameInput").style.display =
						recognition === "yes" || recognition === "maybe" ? "block" : "none";
				}

				function resetSurveyForm() {
					// Resets radio buttons and hides the name input field
					document.getElementById("surveyQuestion").reset();
					document.getElementById("nameInput").style.display = "none";
					document.getElementById("celebrityName").value = ""; // Clears the celebrity name textbox
				}

				function submitResponses() {
					console.log("Submitting responses:", responses);
					// Here you would handle submitting the responses to a server or another destination

					// After submitting the data, clear the content and display a thank-you message

					// Hide the survey container
					document.querySelector(".container").style.display = "none";

					// Create a thank-you message element
					var thankYouMessage = document.createElement("div");
					thankYouMessage.setAttribute("id", "thankYouMessage");
					thankYouMessage.innerHTML =
						"<h2>Thank You!</h2><h5>Your responses have been submitted successfully.</h5>";
					thankYouMessage.style.textAlign = "center";
					thankYouMessage.style.marginTop = "50px";

					// Append the thank-you message to the body or a specific container
					document.body.appendChild(thankYouMessage);

					// Optionally, style the message directly here or in your CSS
					thankYouMessage.style.position = "fixed";
					thankYouMessage.style.left = "50%";
					thankYouMessage.style.top = "50%";
					thankYouMessage.style.transform = "translate(-50%, -50%)";
					thankYouMessage.style.fontSize = "20px";
					thankYouMessage.style.color = "#017cff";
					thankYouMessage.style.backgroundColor = "#fff";
					thankYouMessage.style.padding = "20px";
					thankYouMessage.style.borderRadius = "10px";
					thankYouMessage.style.boxShadow = "0 4px 8px  rgb(14, 145, 157)";
				}
			</script>
		</div>
	</body>
</html>
